**VERIFICANDO A CONECTIVIDADE DE URLs**</br></br>

Este projeto de python visa identificar se um URL est√° online ou offline, retornando uma mensagem para o usu√°rio.

Ele √© composto pela pasta **sitechecker** que cont√©m 4 arquivos de c√≥digo (**__init__.py**, **__main__.py**, **checker.py** e **cli.py**), pelo **.gitignore**, pelo **requirements.txt**, al√©m deste arquivo (**README.md**).</br></br>


**INSTRU√á√ïES**</br></br>


**1.** Para iniciar esta aplica√ß√£o, recomenda-se utilizar um ambiente virtual (venv). Para isso, voc√™ deve abrir um terminal no programa de sua prefer√™ncia e rodar os comandos:

```
cd meuprojeto
python -m venv venv
source venv/Scripts/activate
```

**Entendendo um pouco melhor**</br> O **cd meuprojeto** abre uma pasta chamada meuprojeto; o **python -m venv venv** cria o ambiente virtual; e o **source venv/Scripts/activate** ativa o ambiente virtual criado - isso para o Windows.</br></br>
**Observa√ß√£o**</br> Voc√™ j√° deve ter criado a pasta meuprojeto.</br></br>


**2.** Para organizar o seu projeto, voc√™ deve criar uma pasta para armazenar os seus c√≥digos. Basta voc√™ digitar no seu terminal:

```mkdir sitechecker```

Dentro dessa pasta voc√™ gera os arquivos **__init__.py**, **__main__.py**, **checker.py** e **cli.py**, a partir de:

```
touch sitechecker/__init__.py
touch sitechecker/__main__.py
touch sitechecker/checker.py
touch sitechecker/cli.py
```

Agora, voc√™ deve montar os seus c√≥digos.</br></br>


**3.** O arquivo **checker.py** √© respons√°vel por fornecer as principais funcionalidades da aplica√ß√£o. Ent√£o, abra ele no seu editor de c√≥digo e adicione o c√≥digo respons√°vel por verificar a conectividade do site.


```
# checker.py

from http.client import HTTPConnection
from urllib.parse import urlparse

def site_is_online(url, timeout=2):
    """Return True if the target URL is online.

    Raise an exception otherwise.
    """
    # Defines a generic Exception as placeholder
    error = Exception("Ops, algo deu errado.")
    # Parses URL and finds host
    parser = urlparse(url)
    host = parser.netloc or parser.path.split("/")[0]
    # Starts a for loop using HTTP and HTTPs ports
    for port in (80, 443):
        connection = HTTPConnection(host=host, port=port, timeout=timeout)
        try:
            connection.request("HEAD", "/")
            return True
        except Exception as e:
            error = e
        finally:
            connection.close()
    raise error
```


**Entendendo um pouco melhor**</br> 
A fun√ß√£o site_is_online faz uma solicita√ß√£o de conex√£o ao URL para ver se ele est√° online. Se estiver, retorna True, sen√£o gera uma exce√ß√£o/erro que exibe o problema encontrado.</br></br>


**4.** O arquivo **cli.py** √© respons√°vel por conter as linhas de comando da aplica√ß√£o. Ou seja, como devem ser os comandos que voc√™ d√° para que o projeto funcione adequadamente. Para inserir essas configura√ß√µes, abra o arquivo no seu editor e adicione o c√≥digo abaixo.


```
# cli.py

import argparse

def read_user_cli_args():
    """Handle the CLI arguments and options."""
    parser = argparse.ArgumentParser(
        prog="sitechecker", description="Teste a disponibilidade de uma URL."
    )
    parser.add_argument(
        "-u",
        "--urls",
        metavar="URLs",
        nargs="+",
        type=str,
        default=[],
        help="Insira um ou mais URLs.",
    )
    return parser.parse_args()
        
def display_check_result(result, url, error=""):
    """Display the result of a connectivity check."""
    print(f'O status da "{url}" √©:', end=" ")
    if result:
        print('"Online!" üëç')
    else:
        print(f'"Offline?" üëé \nErro: "{error}".')
```  


**Entendendo um pouco melhor**</br> 
Neste, como mencionado acima, voc√™ define como devem ser os comandos que o usu√°rio vai colocar para fazer com que a funcionalidade rode e ele receba algum resultado. Ent√£o, voc√™ diz que ele deve inserir -u ou --urls e que deve ser um texto. Caso o site esteja online, ele recebe uma mensagem dizendo "O status da "url" √©: "Online!" üëç" ou, caso esteja offline, recebe "O status da "url" √©: "Offline?" üëé Erro: "tipo de erro"."  

**Observa√ß√£o**</br> Voc√™ vai observar que o c√≥digo aqui exposto e o fornecido no arquivo **cli.py** s√£o um pouco diferentes. No c√≥digo do arquivo h√° linhas com #, que s√£o um outro argumento para tentar ler e verificar a conectividade de uma lista de URLs em um arquivo. Ressalta-se, no entanto, que para que esse tipo de an√°lise seja poss√≠vel, outras altera√ß√µes devem ser feitas nos c√≥digos. Inclusive, se voc√™ retirar os #, e tentar ler um arquivo por meio de cat (nome_do_arquivo.extens√£o), ele consegue ler os URLs, mas quando vai realizar a an√°lise, ele n√£o roda.</br></br>


**5.** Para que a aplica√ß√£o funcione corretamente, voc√™ deve escrever um c√≥digo que conecte os c√≥digos anteriores. Esse c√≥digo deve ficar armazenado no arquivo **__main__.py**. Assim, abra-o no seu editor e insira as linhas abaixo:


```
#__main__.py

import sys

from asyncore import read
from sitechecker.checker import site_is_online
from sitechecker.cli import display_check_result, read_user_cli_args

def main():
    user_args = read_user_cli_args()
    urls = user_args.urls
    if not urls:
        print("Faltou colocar um URL. Caso precise de ajuda, ap√≥s sitechecker digite --help.")
        sys.exit(1)
    _site_check(urls)

def _site_check(urls):
    for url in urls:
        error = ""
        try:
            result = site_is_online(url)
        except Exception as e:
            result = False
            error = str(e)
        display_check_result(result, url, error)

if __name__ == "__main__":
    main()
```


**Entendendo um pouco melhor**</br> 
Voc√™ define 3 fun√ß√µes que puxam informa√ß√µes deste e dos outros arquivos. Na def main(), por exemplo, voc√™ chama read_user_cli_args() para analisar os argumentos da linha de comando (aquilo que voc√™ insere) e armazena na vari√°vel user_args local. Ent√£o, ele vai verificar se voc√™ esqueceu de colocar um url, se sim, aparece a mensagem "Faltou colocar um URL. Caso precise de ajuda, ap√≥s sitechecker digite --help.". Caso voc√™ tenha colocado, ele vai chamar a fun√ß√£o _site_check() - respons√°vel por receber a lista de URLs- e aplicar a fun√ß√£o site_is_online. Assim, as conex√µes com os sites s√£o solicitadas, se der certo, retorna true e se der errado, um erro.

**Observa√ß√£o**</br> Voc√™ vai observar que o c√≥digo aqui exposto e o fornecido no **__main__.py** s√£o um pouco diferentes. No c√≥digo do arquivo h√° linhas com #, que s√£o coment√°rios contendo peda√ßos de c√≥digos para ler urls de um arquivo. 
Ressalta-se, no entanto, que para que esse tipo de an√°lise seja poss√≠vel, outras altera√ß√µes devem ser feitas nos c√≥digos. Inclusive, se voc√™ retirar os # e tentar ler um arquivo por meio de cat (nome_do_arquivo.extens√£o), ele consegue ler os URLs, mas quando vai realizar a an√°lise, ele n√£o roda.</br></br>


**6.** O arquivo **__init__.py** √© respons√°vel por ativar o projeto como um pacote do Python. Nele, voc√™ pode escrever a vers√£o da aplica√ß√£o.</br></br>

**7.** O **.gitignore** √© um arquivo de texto respons√°vel por informar ao Git quais arquivos ou pastas do projeto ele deve ignorar. Voc√™ pode pegar um arquivo de **.gitignore** na internet. No projeto atual, o principal arquivo que deve estar no **.gitignore** √© o do venv.


```
# Environments
.env
.venv
env/
venv/
ENV/
env.bak/
venv.bak/
```
</br>


**MEXENDO NA APLICA√á√ÉO**


Para verificar se o seu projeto est√° funcionando, voc√™ deve abrir um terminal e inserir:

```
python -m sitechecker -(AQUI VOC√ä COLOCA UM DOS ARGUMENTOS QUE VOC√ä CONFIGUROU)
```


Ex.:</br>
```
python -m sitechecker -h
```

Ele retorna:</br>

```
usage: sitechecker [-h] [-u URLs [URLs ...]]

Teste a disponibilidade de uma URL.

optional arguments:
  -h, --help            show this help message and exit
  -u URLs [URLs ...], --urls URLs [URLs ...]
                        Insira um ou mais URLs.
```


Caso voc√™ queira ver a conectividade de um site, voc√™ deve digitar:

```
python -m sitechecker -u (AQUI VOC√ä DIGITA O URL)
```

Ex.:</br> 
```
python -m sitechecker -u www.uol.com.br
```

Ele retorna:</br> 
```
O status da "www.uol.com.br" √©: "Online!" üëç
```

Caso queira colocar mais de um URL, basta adicionar os demais ap√≥s o primeiro, sempre deixando um espa√ßo entre eles.

Ex.:</br>
```
python -m sitechecker -u www.uol.com.br www.recordnews.com.br
```

Ele retorna: 
```
O status da "www.uol.com.br" √©: "Online!" üëç
O status da "www.recordnews.com.br" √©: "Online!" üëç
```
